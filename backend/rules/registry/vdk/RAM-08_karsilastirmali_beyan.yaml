rule_id: RAM-08
name: "Karsilastirmali Beyan Sapmasi"
name_tr: "Yillar Arasi Sapma Analizi"
version: "1.0.0"
category: "RAM"
priority: "MEDIUM"
severity: "MEDIUM"
description: |
  Yillar arasi onemli sapmalari kontrol eder.

legal_basis_refs:
  - "VDK Risk Analizi Modeli (RAM)"

inputs:
  - name: onceki_yil_gelir
    type: decimal
    required: false
    source: "beyanname"
  - name: cari_yil_gelir
    type: decimal
    required: true
    source: "beyanname"

algorithm: |
  # Requires historical data
  if onceki_yil_gelir and onceki_yil_gelir > 0:
    sapma = abs(cari_yil_gelir - onceki_yil_gelir) / onceki_yil_gelir
    if sapma > 0.50:
      status = 'warning'
      score = 5
    else:
      status = 'pass'
      score = 0
  else:
    status = 'pending'
    score = 0

thresholds:
  yillik_sapma_limit: 0.50

outputs:
  - name: status
    type: string
    enum: ['pass', 'fail', 'warning', 'pending']
  - name: score
    type: integer
    range: [0, 10]

test_cases:
  - name: "Veri eksik"
    inputs: {onceki_yil_gelir: null, cari_yil_gelir: 1000000}
    expected: {status: "pending", score: 0}
  - name: "Normal sapma"
    inputs: {onceki_yil_gelir: 900000, cari_yil_gelir: 1000000}
    expected: {status: "pass", score: 0}

created_at: "2026-01-05T00:00:00Z"
updated_at: "2026-01-05T00:00:00Z"
