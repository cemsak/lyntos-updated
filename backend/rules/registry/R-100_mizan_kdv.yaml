rule_id: R-100
name: "Mizan vs KDV Beyani Kontrolu"
version: "1.0.0"
category: "CROSS_CHECK"
priority: "HIGH"
description: |
  Mizan 600 hesabi ile KDV beyani satislarini karsilastirir.
  VUK Madde 227 Defter-Beyan uyumu

legal_basis_refs:
  - SRC-0045

inputs:
  - name: mizan_600
    type: decimal
    required: true
    description: "Mizan 600 hesap bakiyesi"

  - name: kdv_beyan_satis
    type: decimal
    required: true
    description: "KDV beyani satis tutari"

algorithm: |
  fark = abs(mizan_600 - kdv_beyan_satis)
  tolerance_abs = 100
  tolerance_pct = 0.05

  if fark > tolerance_abs and fark > (mizan_600 * tolerance_pct):
    status = "warning"
    reason = f"Mizan ve KDV beyani arasinda {fark} TL fark var"
  else:
    status = "ok"

thresholds:
  absolute: 100
  percentage: 0.05

evidence_required:
  - mizan_600.csv
  - kdv_beyani.pdf

test_cases:
  - name: "Uyumlu"
    inputs:
      mizan_600: 1000000
      kdv_beyan_satis: 1000050
    expected:
      status: "ok"

  - name: "Uyumsuz"
    inputs:
      mizan_600: 1000000
      kdv_beyan_satis: 1100000
    expected:
      status: "warning"

created_at: "2026-01-01T00:00:00Z"
updated_at: "2026-01-01T00:00:00Z"
